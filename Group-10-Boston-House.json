{"paragraphs":[{"text":"%pyspark\nfrom pyspark.sql.types import *\nfrom pyspark.sql import Row\nimport pyspark.mllib\nimport pyspark.mllib.regression\nfrom pyspark.mllib.regression import LabeledPoint\nfrom pyspark.sql.functions import *\nhouses = sc.textFile('hdfs://sandbox.hortonworks.com/tmp/boston-data/boston_house.csv')\nheader = houses.first()\nheaderless_houses = houses.filter(lambda line: line != header)\nrdd = headerless_houses.map(lambda line: line.split(\",\"))\ndf = rdd.map(lambda line: Row(A = line[0], B = line[1], C=line[2], D=line[3], E=line[4], F=line[5], G=line[6], H=line[7], I=line[8], J=line[9], K=line[10], L=line[11], M=line[12], N=line[13])).toDF()\n#df.show(5)\nfrom pyspark.mllib.util import MLUtils\nfrom pyspark.mllib.linalg import Vectors\nfrom pyspark.mllib.feature import StandardScaler\nfeatures = df.map(lambda row: row[0:13])\nstandardizer = StandardScaler(withMean=True, withStd=True)\nmodel = standardizer.fit(features)\nfeatures_transform = model.transform(features)\nlabels = df.map(lambda row: row[13])\ntransformedData = labels.zip(features_transform)\ntransformedData = transformedData.map(lambda row: LabeledPoint(row[0],[row[1]]))\n#print(transformedData.take(5))\nfrom pyspark.mllib.regression import LinearRegressionWithSGD\nlinearModel = LinearRegressionWithSGD.train(transformedData, intercept = True)\n#print(linearModel.weights)\nverhouses = sc.textFile('hdfs://sandbox.hortonworks.com/tmp/boston-data/verification.csv')\nverheader = verhouses.first()\nverheaderless_houses = verhouses.filter(lambda line: line != verheader)\nverrdd = verheaderless_houses.map(lambda line: line.split(\",\"))\nverdf = verrdd.map(lambda line: Row(A = line[0], B = line[1], C=line[2], D=line[3], E=line[4], F=line[5], G=line[6], H=line[7], I=line[8], J=line[9], K=line[10], L=line[11], M=line[12])).toDF()\nverfeatures = verdf.map(lambda row: row[0:13])\nverfeatures_transform = model.transform(verfeatures)\n#vertransformedData = verfeatures_transform.map(lambda row: LabeledPoint(row))\n#print(features_transform.take(3))\n#print(verfeatures_transform.take(3))\nverify_predictions = linearModel.predict(verfeatures_transform)\nverify_predictions.saveAsTextFile('hdfs://sandbox.hortonworks.com/tmp/boston-data/predicted_results');\n#resultsplit = result.map(lambda value: value).collect()\n\n","dateUpdated":"2016-09-29T20:55:54+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1474589713302_1333442641","id":"20160923-001513_1902950486","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2016-09-23T12:15:13+0000","dateStarted":"2016-09-29T20:55:57+0000","dateFinished":"2016-09-29T20:58:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:427","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475081580028_1213870338","id":"20160928-165300_743636785","dateCreated":"2016-09-28T04:53:00+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:428"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475028705820_1778722386","id":"20160928-021145_1751158530","dateCreated":"2016-09-28T02:11:45+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:429"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475028491106_-1856170684","id":"20160928-020811_579598776","dateCreated":"2016-09-28T02:08:11+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:430"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475028461210_537336900","id":"20160928-020741_128240923","dateCreated":"2016-09-28T02:07:41+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:431"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475028457433_1042881630","id":"20160928-020737_329745072","dateCreated":"2016-09-28T02:07:37+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:432"},{"dateUpdated":"2016-09-27T11:58:52+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475020708724_1433552911","id":"20160927-235828_1577429155","dateCreated":"2016-09-27T11:58:28+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:433"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475020705035_-309744355","id":"20160927-235825_418042978","dateCreated":"2016-09-27T11:58:25+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:434"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475020524450_-1670444684","id":"20160927-235524_467616351","dateCreated":"2016-09-27T11:55:24+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:435"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475020522511_1499132079","id":"20160927-235522_967542711","dateCreated":"2016-09-27T11:55:22+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:436"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475020522212_1711128723","id":"20160927-235522_1904436988","dateCreated":"2016-09-27T11:55:22+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:437"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475020518604_-1228969130","id":"20160927-235518_828820326","dateCreated":"2016-09-27T11:55:18+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:438"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475020512963_-1776097390","id":"20160927-235512_1058800342","dateCreated":"2016-09-27T11:55:12+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:439"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475020511436_-1190124815","id":"20160927-235511_1284275558","dateCreated":"2016-09-27T11:55:11+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:440"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475020509985_-2109289938","id":"20160927-235509_1572482885","dateCreated":"2016-09-27T11:55:09+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:441"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475011415995_1382035797","id":"20160927-212335_1865783878","dateCreated":"2016-09-27T09:23:35+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:442"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475011414864_1717152089","id":"20160927-212334_292118078","dateCreated":"2016-09-27T09:23:34+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:443"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475011413948_592146305","id":"20160927-212333_848230107","dateCreated":"2016-09-27T09:23:33+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:444"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1475007793667_-1680347023","id":"20160927-202313_1175214182","dateCreated":"2016-09-27T08:23:13+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:445"}],"name":"Group-10-Boston-House","id":"2BVZMRCXG","angularObjects":{"2BW4S5NJ4:shared_process":[],"2BY1Y2HJG:shared_process":[],"2BVYH21ZJ:shared_process":[],"2BV6637D6:shared_process":[],"2BX5CPDSX:shared_process":[],"2BWHGGFZJ:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}